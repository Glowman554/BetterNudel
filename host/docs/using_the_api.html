<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/prism.css">
		<script src="/js/components.js"></script>
		<script src="/js/prism.js"></script>


		<title>BetterNudel | Documentation</title>

	</head>
	<body>
		<script>
			(async _ => {
				document.body.append(documentation_page("Using the api", {
					name: "Api login start call",
					content: join_components(
						create_text("This is the api endpoint needed to start the login process. You need to provide your discord tag and the api reutrn's a login id."),
						create_code_block(`
function start_login(discord_tag) {
	return new Promise((resolve, reject) => {
		fetch("https://x.glowman554.gq/auth/login/start?discord_id=" + discord_tag.replace("#", "%23")).then(response => response.json()).then(response => {
			resolve(response.id);
		});
	});
}`, `js`)
					)
				},
				{
					name: "Api login stop call",
					content: join_components(
						create_text("This is the api endpoint needed to stop/cancel the login process. You need to provide your login id."),
						create_code_block(`
function status_login(login_id) {
	return new Promise((resolve, reject) => {
		fetch("https://x.glowman554.gq/auth/login/status?login_id=" + login_id).then(response => response.json()).then(response => {
			resolve(response.token);
		});
	});
}`, `js`)
					)
				},
				{
					name: "Api login status call",
					content: join_components(
						create_text("This is the api endpoint needed to check the status of the login process. You need to provide your login id and the api return's the login token if it succeeded."),
						create_code_block(`
function status_login(login_id) {
	return new Promise((resolve, reject) => {
		fetch("https://x.glowman554.gq/auth/login/status?login_id=" + login_id).then(response => response.json()).then(response => {
			resolve(response.token);
		});
	});
}`, `js`)
				)
			},
			{
				name: "Api self message call",
				content: join_components(
					create_text("This api endpoint can be used to send a message to yourself. You need to provide your login token and the message you want to send."),
					create_code_block(`
function self_message(message, login_token) {
	return new Promise((resolve, reject) => {
		fetch("https://x.glowman554.gq/api/self_message?body=" + encodeURIComponent(message) + "&login_token=" + login_token).then(response => response.text()).then(response => {
			resolve(response);
		});
	});
}`, `js`)
				)
			},
			{
				name: "Putting it all together",
				content: join_components(
					create_code_block(`
async function login(discord_tag) {
	let login_id = await start_login(discord_tag);
	let token = null;
	do {
		token = await status_login(login_id);

		if (token == null) {
			await new Promise(resolve => setTimeout(resolve, 1000));
		}
	} while (token == null);

	return token;
}

login("Glowman554#4152").then(token => {
	self_message("Hello, world!", token).then(response => {
		console.log(response);
	});
});
					`, `js`),
					create_text("The above code will login and send a message to yourself."),
					create_text("The full code can be found <a href='/js/api_example.js'>here</a>.")
				)
			}));
			})();
		</script>
	</body>
</html>